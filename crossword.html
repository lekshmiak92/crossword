<!DOCTYPE html>
<html>
<head>
	<title>Crossword</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
	<style type="text/css">
		.container{
			margin: 2rem auto;
		}
		.deadBlock{
			background-color: #3e3e3e;
			color: #3e3e3e;
		}
		.table {
			width: 50%;
			max-width: 100%;
		}
		table#gameBoard {
		    margin: auto;
		}
		td{
			text-align: center;
			border: 1px solid grey;


		}

		.liveBlock{
			color: white;

		}
		td input {
			width: 4rem;
			border: none;
    		text-align: center;
    		background-color: transparent;
		}

		label{
			float: left;
			font-size: 10px;
		}
		.text-trans{
			visibility: hidden;
		}
		input:focus {
			outline: none;
		}

		div#userControl{
		    width: 50%;
		    margin: 3rem auto;
		}

		.bg-green{
			background-color: #60db60 ;
		}

		.higlight-red{
			outline: 1px solid #f52828;
			    background-color: #f56236;
		}
		.highlight-blue{
			outline: 2px solid #0e2cff;
		    outline-style: auto;
		    background-color: #fbfb6bb3;
		}
		div.userAction{
			margin: 2rem;
			overflow: hidden;
		}
		div.action {
		    display: block;
		    float: left;
		    text-align: center;
		}
		input#userInput {
		    text-transform: uppercase;
		}
		/*siblingRadio*/

		.radio+.radio {
		    margin-top: 10px;
		}
		.cluebox {
		    padding: 0 8rem;
		}
		header{
			text-align: center;
		}
		img.logo{
			width: 20%;

		}

	</style>
</head>
<body>
	<header>
		<img class="logo"src="./logo.jpg">
	
	</header>
	<div class="container">
		<div class="gameArea row">
			<div id="gameWrap">
				<table id="gameBoard" class="table table-bordered table-striped table-condensed">
					
				</table>
			</div>

			<div id="userControl" class="row">
				<input type="text" class="form-control" id="userInput" name="">
				<div class="userAction">
					<div class="radio action col-md-3">
						<input type="radio" id="across" name="direction">Across</input>
					</div>
					<div class="radio action col-md-3">
						<input type="radio" id="down" name="direction">Down</input>
					</div>
					<div class=" action col-md-3">
						<button id="checkBtn" class=" btn btn-primary">Check</button>
					</div>
					<div class=" action col-md-3">
						<button id="clueBtn" class=" btn btn-warning">All Clues</button>
					</div>
				</div>
			</div>
			<div class="cluebox" id="clueBox">
				<h3>Clues</h3>
				<div id="cluesDown" class="col-md-6">
					<h4>Down:</h4>
				</div>
				<div id="cluesAcross" class="col-md-6">
					<h4>Across:</h4>

				</div>
				
			</div>
			
		</div>
		
	</div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
	<script type="text/javascript">

		var apiData = {"acrossmap":null,"admin":false,"answers":{"across":["MWAHAHA","HASACOW","AEROSOL","ONELOVE","RIMSHOT","TATTLER","GRIT","TETRIS","DRE","IDE","RHOS","ARCO","NOSEBLEED","SNOOP","GEODESICDOME","MERGER","CARMEN","ICECREAMCONE","CLAUS","LIONTAMER","HELP","SETH","AMO","ACT","SUREOF","BLOB","ETICKET","RANLATE","LIMEADE","TRAILER","SCENTED","SEEPAST"],"down":["MARGIN","WEIRDO","ARMIES","HOST","ASH","HOOT","ALTERED","HOTRODS","ANAIS","SETS","ALT","COLDROOM","OVERCOME","WEREOPEN","THEE","ANDREA","EGGCUP","BEERS","LORE","SCANT","ICON","MICHAELS","ECLECTIC","REALTIME","ALERTED","MITE","COHORTS","MALALA","EMOTES","ROBERT","SUEDE","SKAT","FARE","BLIP","CEN","NAE"]},"author":"Caleb Madison","autowrap":null,"bbars":null,"circles":null,"clues":{"across":["1. Outburst after a nefarious plan is hatched","8. Freaks","15. What may be propelled by a propellant","16. Classic song with the lyric &quot;Let's get together and feel all right&quot;","17. Response to a joke","18. Rat","19. Steadfast determination","20. Game where you don't want to reach the top","22. Mac ___ (former Bay Area hip-hop great)","23. Chemical suffix","24. P's","25. Direction to a cellist","26. What &quot;epistaxis&quot; is a fancy medical term for","30. Play detective","31. Epcot's Spaceship Earth, architecturally","33. Big business news","36. Opera with the &quot;Gypsy Song&quot;","37. Treat with an edible container","41. Santa ___","42. Person who's whip-smart?","46. Rightmost option in most menu bars","47. Actor Green of the &quot;Austin Powers&quot; movies","48. &quot;Odi et ___&quot; (Catullus poem)","49. It's not for real","50. Not doubting at all","52. Amoeba, e.g.","53. One might be sent to a passenger's phone","55. Went over","57. Minute Maid drink","58. It comes after &quot;Coming soon ...&quot;","59. Perfumed","60. Not get hung up on"],"down":["1. Site for a doodle","2. Kook","3. Large numbers","4. Large number","5. An end to smoking?","6. Hilarious sort","7. Like some suits and states","8. Street racers","9. Diarist Nin","10. Live musicians play them","11. Delaware has the lowest mean one in the U.S.: Abbr.","12. Food storage spot","13. Triumph","14. &quot;Come on in!&quot;","21. Pronoun in &quot;America&quot;","25. Girl's name in the U.S. that's a boy's name in Italy","27. Ceramic breakfast accouterment","28. Round parts?","29. Stories that may or may not be true","30. Meager","32. Recognizable figure","33. Sportscaster inducted into the Television Hall of Fame in 2013","34. Having a little of this and a little of that","35. Live-streamed, say","38. Let know","39. Tiny bit","40. Companions","43. ___ Yousafzai, 2014 Nobel Peace Prize winner","44. Performs too broadly","45. King in &quot;Game of Thrones&quot;","47. Nice jacket material","50. Three-player game","51. Meter reading","52. It's hardly worth noticing","54. The 2000s, e.g.: Abbr.","56. Tayside turndown"]},"code":null,"copyright":"2019, The New York Times","date":"4/19/2019","dow":"Friday","downmap":null,"editor":"Will Shortz","grid":["M","W","A","H","A","H","A",".","H","A","S","A","C","O","W","A","E","R","O","S","O","L",".","O","N","E","L","O","V","E","R","I","M","S","H","O","T",".","T","A","T","T","L","E","R","G","R","I","T",".","T","E","T","R","I","S",".","D","R","E","I","D","E",".",".",".","R","H","O","S",".","A","R","C","O","N","O","S","E","B","L","E","E","D",".","S","N","O","O","P",".",".",".","G","E","O","D","E","S","I","C","D","O","M","E","M","E","R","G","E","R",".",".",".","C","A","R","M","E","N","I","C","E","C","R","E","A","M","C","O","N","E",".",".",".","C","L","A","U","S",".","L","I","O","N","T","A","M","E","R","H","E","L","P",".","S","E","T","H",".",".",".","A","M","O","A","C","T",".","S","U","R","E","O","F",".","B","L","O","B","E","T","I","C","K","E","T",".","R","A","N","L","A","T","E","L","I","M","E","A","D","E",".","T","R","A","I","L","E","R","S","C","E","N","T","E","D",".","S","E","E","P","A","S","T"],"gridnums":[1,2,3,4,5,6,7,0,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,16,0,0,0,0,0,0,17,0,0,0,0,0,0,0,18,0,0,0,0,0,0,19,0,0,0,0,20,0,21,0,0,0,0,22,0,0,23,0,0,0,0,0,24,0,0,0,0,25,0,0,0,26,0,0,27,28,29,0,0,0,0,30,0,0,0,0,0,0,0,31,0,0,0,0,0,32,0,0,0,0,0,33,34,35,0,0,0,0,0,0,36,0,0,0,0,0,37,0,0,0,0,0,38,39,40,0,0,0,0,0,0,41,0,0,0,0,0,42,0,0,0,0,0,43,44,45,46,0,0,0,0,47,0,0,0,0,0,0,48,0,0,49,0,0,0,50,0,0,0,0,51,0,52,0,0,0,53,0,0,54,0,0,0,0,55,0,56,0,0,0,0,57,0,0,0,0,0,0,0,58,0,0,0,0,0,0,59,0,0,0,0,0,0,0,60,0,0,0,0,0,0],"hastitle":false,"hold":null,"id":null,"id2":null,"interpretcolors":null,"jnotes":null,"key":null,"mini":null,"navigate":true,"notepad":null,"publisher":"The New York Times","rbars":null,"shadecircles":null,"size":{"cols":15,"rows":15},"target":"/Crossword?date=4/19/2019","title":"NY TIMES, FRI, APR 19, 2019","track":null,"type":null,"uniclue":false,"valid":true}

		var answerStructure = {};
		var gridData = {};
		var rows = apiData.size.rows;
		var cols = apiData.size.cols;
		var totalCells = rows * cols ;
		var selectedClueNum = 0;





		


		function generateGridData(){
			var totalCells = apiData.size.rows * apiData.size.cols;
			var cellLabel;

			for (var i = 0; i < totalCells; i++) {
				if (apiData.gridnums[i] === 0) {
					cellLabel = ""
				}else{
					cellLabel = apiData.gridnums[i];
				}
				gridData[i+1] = {
					label: cellLabel,
					letter: apiData.grid[i],
					showLetter:false,
					status:null,
					setfield:false

				}
			}

			console.log(gridData)

		}

		function generateAnswerStructure() {
			var clueAcross = apiData.clues.across;
			var clueDown = apiData.clues.down;


			for (var i = 0; i < clueAcross.length ; i++) {
				var clue = clueAcross[i];
				var splittedClue = clue.split(".");
				var gridNum = splittedClue[0];
				var indexName = gridNum + "_across";
				var connectedCellsArray = [];
				var startCell = apiData.gridnums.indexOf(Number(gridNum))+1;

				for (var j = 0; j < apiData.answers.across[i].length; j++) {
					connectedCellsArray.push(startCell + j)
				}

				answerStructure[indexName] = {
					
						answer: apiData.answers.across[i],
						length: apiData.answers.across[i].length,
						connectedCells : connectedCellsArray
					
				}


			}

			for (var i = 0; i < clueDown.length; i++) {
				var clue = clueDown[i];
				var splittedClue = clue.split(".");
				var gridNum = splittedClue[0];
				var indexName = gridNum + "_down";
				var connectedCellsArray = [];
				var startCell = apiData.gridnums.indexOf(Number(gridNum))+1;

				for (var j = 0; j < apiData.answers.down[i].length; j++) {
					connectedCellsArray.push(startCell + (j*cols))
				}

				answerStructure[indexName] = {
					
						answer: apiData.answers.down[i],
						length: apiData.answers.down[i].length,
						connectedCells : connectedCellsArray,
						cell : startCell
				}


			}

			console.log(answerStructure)

		}


		function getPuzzleLayout(){
     		 $board = $("#gameBoard");
     		 $board.empty();
     		 var count = 0;


			for (var i = 1; i <= totalCells; i++) {

				count ++ ;
				if (count == 1) {
					$board.append("<tr>");
				}else if(count>14) {
					count = 0;
				}

				if(!gridData[i].showLetter) {
					if (gridData[i].letter === "."){
						$board.children().last().append('<td id="'+i+'"class="deadBlock"></td>');

					}else{

						$board.children().last().append('<td id="'+i+'"class="clueNum" data-gridNum="'+gridData[i].label+'"><label>'+gridData[i].label+'</label><input maxlength="1" readonly/>'+"</td>");
					}
				}
				
				else if ((gridData[i].showLetter) && (gridData[i].status === "correct")) {
					$board.children().last().append('<td id="'+i+'"class="clueNum bg-green" data-gridNum="'+gridData[i].label+'"><label>'+gridData[i].label+'</label><input maxlength="1" value="'+gridData[i].letter+'" readonly/>'+"</td>");
				}

				else if ((gridData[i].showLetter) && (gridData[i].status === "wrong")) {
					$board.children().last().append('<td id="'+i+'"class="clueNum higlight-red" data-gridNum="'+gridData[i].label+'"><label>'+gridData[i].label+'</label><input maxlength="1" readonly value="'+gridData[i].letter+'"/></td>');
				}
				
			}

			
		}

		function showClues(apidata){
	      var cluesArrayAcross = apiData.clues.across;
	      var cluesArrayDown = apiData.clues.down;

	      $("#clueBox").empty();
	      $("#clueBox").append('<h3>Clues</h3><div id="cluesDown" class="col-md-6"><h4>Down:</h4>')
	      for (var i = 0; i< cluesArrayDown.length; i++) {
	        $("#cluesDown").append("<p>"+cluesArrayDown[i]+"<p>");
	      }
	      $("#clueBox").append('<div id="cluesAcross" class="col-md-6"><h4>Across:</h4>')

	      for (var i = 0; i < cluesArrayAcross.length; i++) {
	        $("#cluesAcross").append("<p>"+cluesArrayAcross[i]+"<p>");
	      }



	    }
	    function fetchClue() {
	    	console.log(this);
	    	$("td").removeClass("highlight-blue");
	    	$(this).addClass("highlight-blue");
	    	var gridNumber,acrossKey,downKey;
	    	gridNumber = Number($(this).attr("data-gridNum"));
	    	selectedClueNum= gridNumber;
	    	acrossKey = gridNumber+ "_across";
	    	downKey = gridNumber+ "_down";

	    	$("#clueBox").empty();


			if ((answerStructure[downKey]) && (answerStructure[acrossKey])){
		        var valueAcross = answerStructure[acrossKey].answer;
		          var indexAcross = apiData.answers.across.indexOf(valueAcross);
		          var valueDown = answerStructure[downKey].answer;
		          var indexDown = apiData.answers.down.indexOf(valueDown);


		        $("input#down input#across").attr("disabled",false)
		        $("input#across input#down").attr("checked",false)

		        $("#clueBox").append('<h4>Across:</h4><p>'+ apiData.clues.across[indexAcross] +'&nbsp; ('+ valueAcross.length + ")</p><br/>");
		        $("#clueBox").append('<h4>Down:</h4><p>'+ apiData.clues.down[indexDown] + '&nbsp; ('+ valueDown.length +")</p><br/>");

		      } else if ((answerStructure[acrossKey]) && !(answerStructure[downKey])){
		        var value = answerStructure[acrossKey].answer;
		          var index = apiData.answers.across.indexOf(value);

		          $("input#down").attr("checked",false).attr("disabled",true)
		          $("input#across").attr("disabled",false).attr("checked",true)

		        $("#clueBox").append('<h4>Across:</h4><p>'+ apiData.clues.across[index] +'&nbsp; ('+ value.length + ")</p><br/>");
		      } 
		      else if ((!answerStructure[acrossKey]) && (answerStructure[downKey])) {
		        var value = answerStructure[downKey].answer;
		          var index = apiData.answers.down.indexOf(value);
		          $("input#across").attr("checked",false).attr("disabled",true);
		          $("input#down").attr("disabled",false).attr("checked",true)

		        $("#clueBox").append('<h4>Down:</h4><p>'+ apiData.clues.down[index] + '&nbsp; ('+ value.length +")</p><br/>");
		      }
		      else if((!answerStructure[acrossKey]) && (!answerStructure[downKey])) {
		        $("input#down input#across").attr("disabled",true)
		        $("input#across input#down").attr("checked",false)
		      }

	    }

	    function compareResult(selectedClueNum,direction,value) {
	    	var key = selectedClueNum+"_"+direction;
	    	var input = value;
	    	var correctAnswer= answerStructure[key].answer;
	    	console.log(answerStructure[key])

	    	if (value === correctAnswer){
	    		for (var i = 0; i < correctAnswer.length; i++) {
	    			var gridCell = answerStructure[key].connectedCells[i];

	    			if (gridData[gridCell].status !== "correct") {
		    			gridData[gridCell].showLetter = true;
		    			gridData[gridCell].letter = correctAnswer.charAt(i);
		    			gridData[gridCell].status = "correct";

	    			}

	    		}
	    	}
	    	else{
	    		for (var i = 0; i < correctAnswer.length; i++) {
	    			var gridCell = answerStructure[key].connectedCells[i];

	    			if (gridData[gridCell].status !== "correct") {
		    			gridData[gridCell].showLetter = true;
		    			gridData[gridCell].letter = input.charAt(i);
		    			gridData[gridCell].status = "wrong";

	    			}

	    		}
	    	}
	    	
	    	getPuzzleLayout();
	    	
	    }

	    function handleClickOfCheck() {
	    	var direction= $("input[name='direction']:checked").attr("id");
	    	var value = $("#userInput").val().toUpperCase();;

	    	compareResult(selectedClueNum,direction,value);
	    }
		
		$(function(){

			

			generateGridData();
			generateAnswerStructure();
			getPuzzleLayout();
			showClues();
			$("#gameBoard").on("click","td",fetchClue)
			$("#checkBtn").on("click",handleClickOfCheck)
			$("#clueBtn").on("click",showClues)
	

		})

	</script>
</body>
</html>